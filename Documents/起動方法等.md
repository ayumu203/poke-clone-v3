# 各種起動方法

## コンテナの起動

```bash
# コンテナをビルドして起動
docker compose up -d --build
# ログを確認
docker compose logs -f app
```

## コンテナの停止・削除

```bash
# コンテナの停止
docker compose stop

# コンテナの停止と削除
docker compose down

# コンテナ、ボリューム、ネットワークをすべて削除（データも削除される）
docker compose down -v
```

## APIの確認

以下のURLでAPIのドキュメントにアクセスできます:

- <http://localhost:5000/swagger/index.html>

### 認証不要のエンドポイント

```bash
# 全件取得
curl -X GET http://localhost:5000/api/pokemon/   -H "Accept: application/json"
# レスポンスを整形して表示
curl -X GET http://localhost:5000/api/pokemon/1 | jq .
# レスポンスを整形して表示
curl -X GET http://localhost:5000/api/moves/1 | jq .
```

### 認証が必要なエンドポイント

```bash
# 認証トークンの作成
TOKEN=$(curl -s -X POST http://localhost:5000/api/Auth/login/mock \
  -H "Content-Type: application/json" \
  -d '{"username":"hogehogeplayer","password":"testpassword"}' \
  | jq -r '.token')

# トークンの確認
echo "取得したトークン: $TOKEN"

# トークンを利用したデータの登録・更新
curl -X POST http://localhost:5000/api/player/me   -H "Authorization: Bearer $TOKEN"   -H "Content-Type: application/json"   -d '{
    "name": "プレイヤー名",
    "iconUrl": "https://example.com/icon.png"
  }'   | jq .

# トークンを利用して取得
curl -X GET http://localhost:5000/api/player/me   -H "Authorization: Bearer $TOKEN"   -H "Accept: application/json"   | jq .
```

## データベースの確認

```bash
# データ件数を確認（PokemonSpecies）
docker exec -it pokeclone_db /opt/mssql-tools18/bin/sqlcmd -S localhost -U sa -P 'Your_Password123!' -d PokeCloneDb -C -Q "SELECT COUNT(*) AS TotalCount FROM PokemonSpecies"

# データ件数を確認（Moves）
docker exec -it pokeclone_db /opt/mssql-tools18/bin/sqlcmd -S localhost -U sa -P 'Your_Password123!' -d PokeCloneDb -C -Q "SELECT COUNT(*) AS TotalCount FROM Moves"

# 最初の5件を確認（PokemonSpecies）
docker exec -it pokeclone_db /opt/mssql-tools18/bin/sqlcmd -S localhost -U sa -P 'Your_Password123!' -d PokeCloneDb -C -Q "SELECT TOP 5 * FROM PokemonSpecies ORDER BY PokemonSpeciesId"

# 最初の5件を確認（Moves）
docker exec -it pokeclone_db /opt/mssql-tools18/bin/sqlcmd -S localhost -U sa -P 'Your_Password123!' -d PokeCloneDb -C -Q "SELECT TOP 5 * FROM Moves ORDER BY MoveId"
```
