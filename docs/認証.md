# 認証・認可に関して

## A. 本番／検証: Azure Entra ID

- **目的**: 本番環境やステージング環境でAPIに制限をかける.
- **備考**: Google認証も追加できる(<https://zenn.dev/microsoft/articles/microsoft_entraid_google_federation>).
- **設定** (`appsettings.json` または環境変数):

```json
{
  "IsAuthenticationEnabled": true,
  "UseLocalJwt": false,
  "AzureEntraId": {
    "Instance": "https://login.microsoftonline.com/",
    "TenantId": "<YourTenantId>",
    "ClientId": "<YourClientId>",
    "Audience": "<YourClientId>"
  }
}
```

## B. ローカル: JWT（HS256）を使った認証

目的: ローカルでの認証付きのAPIの検証を行う.
設定例 (appsettings.Development.json):

```json
{
  "IsAuthenticationEnabled": true,
  "UseLocalJwt": true,
  "Jwt": {
    "Key": "your-very-strong-secret-key-change-this-minimum-32-characters",
    "Issuer": "pokeclone.local",
    "Audience": "pokeclone.local"
  }
}
```

実行方法:

```bash
# サーバの起動
dotnet run --project tools/jwt-generator/jwt-generator.csproj -- "your-very-strong-secret-key-change-this-minimum-32-characters" "example-player-id"

## APIリクエスト
curl -H "Authorization: Bearer <token>" http://localhost:5000/api/players/example-player-id
```

## C: ローカル認証を無効化

```bash
{
  "IsAuthenticationEnabled": false
}
```
